@using AdminHalloDoc.Models.CV;
@model AdminHalloDoc.Entities.ViewModel.AdminViewModel.PaginatedViewModel;
@using static AdminHalloDoc.Entities.ViewModel.Constant
@using static AdminHalloDoc.Entities.ViewModel.CM
@{
    var Status = -1;
    if (Model.DashboardList.Count > 0)
    {
        Status = FindStatus(Model.DashboardList[0].Status);
    }
    List<string> tdHtmlValues = PstatusTdHtmlMap.ContainsKey(Status) ? PstatusTdHtmlMap[Status] : new List<string>();
}   


<div class="card border-0 shadow pb-2 mb-3">
    <div class="table-responsive" style="overflow-x: visible !important;">
        <div class="accordion accordion-flush" id="accordionFlushExample">
            @if (Model.DashboardList.Count < 1)
            {

                <h1 class="text-center mt-3 text-secondary" >No data Found</h1>

            }
            @foreach (var item in Model.DashboardList)
            {
                    <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-heading-@item.Requestid">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#flush-@item.Requestid" aria-expanded="false" aria-controls="collapse_@item.Requestid">
                                <div class="d-flex justify-content-between">
                                    <div>
                                        <div class="pb-3">
                                         @item.PatientName
                                        </div>
                                        <div>
                                        @item.Address
                                        </div>
                                    </div>
                                    <div>
                                        <div class="pb-2">
                                        @Enum.GetName(typeof(RequestType), item.RequestTypeID)  <div class="p-success">
                                        </div>
                                    </div>
                                        <div class="btn btn-outline-info rounded-4 p-1 fs-6 px-2">
                                        <a href="https://www.google.com/maps/search/?api=1&query=@item.Address" class="text-info" target="_blank">Map Location</a>
                                    </div>
                                    </div>
                                </div>
                            </button>
                        </h2>
                    <div id="flush-@item.Requestid" class="accordion-collapse collapse" aria-labelledby="@item.Requestid" data-bs-parent="#accordionFlushExample">
                            <div class="accordion-body">
                                <div class="d-flex align-items-center py-0 position-relative">
                                    
                                    
                                <a href="/Physician/Viewcase/@item.RequestClientid.Encode()" class="btn btn-light rounded-4 p-1 fs-6 px-3 my-2 position-absolute top-0  end-0">
                                    View Case
                                    </a>
                                </div>
                            @if (Status == 3)
                            {
                                <td scope="col">

                                    @if (item.Status == 5)
                                    {
                                        <div data-requestid="@item.Requestid" class="change-state btn btn-info text-white my-3">
                                            House Call
                                        </div>
                                    }
                                    else
                                    {
                                        <div>
                                            -
                                        </div>
                                    }
                                </td>
                            }
                            <div class="d-flex align-items-center py-0">
                                <div class="border border-1 border-info d-flex rounded-5  mb-1">
                                    <i class="bi bi-telephone p-2 py-1 fa-sm"></i>
                                </div>
                                <div class="px-2">
                                    <span class="text-start text-light-emphasis">Patient:</span>
                                    <span class="text-end text-dark">@item.PhoneNumber</span>
                                </div>
                            </div>
                            <div class="d-flex align-items-center py-0">
                                <div class="border border-1 border-info d-flex rounded-5  mb-1">
                                    <i class="bi bi-geo-alt p-2 py-1 fa-sm"></i>
                                </div>
                                <div class="px-2">
                                    <span class="text-start text-light-emphasis">Address:</span>
                                    <span class="text-end text-dark">@item.Address</span>
                                </div>
                            </div>
                            <div class="row">
                                @if (Status == 1)
                                {
                                    <div class="col-6">
                                        <a class="btn btn-info rounded-4 p-1 fs-6 px-5 my-2 js-stkModal-btn"
                                           data-form-id="formEdit_UMS"
                                           data-url='@Url.Action("_AcceptRequest", "ViewAction", new {requestid = @item.Requestid})'
                                           data-modal-size="lg"><i class="px-2 bi bi-journal-plus"></i>Accept </a>
                                    </div>

                                }
                                <div class="col-6">
                                    <a class="btn btn-info rounded-4 p-1 fs-6 px-5 my-2 " asp-action="ViewNotes" asp-route-id="@item.Requestid.Encode()" asp-controller="AdminDashboard">
                                        <i class="px-2 bi bi-journal-medical"></i>View notes</a>

                </div>

                                @if (Status == 2)
                                {
                                    <div class="col-6">
                                        <a class="btn btn-success rounded-4 p-1 fs-6 px-5 my-2 btn em  js-stkModal-btn"
                                           data-form-id="formEdit_UMS"
                                           data-url='@Url.Action("_TransfertoAdmin", "ViewAction", new {requestid = @item.Requestid})'
                                           data-modal-size="lg"><i class="px-2 bi bi-journal-plus"></i>Transfer  </a>
                                    </div>
                                    <div class="col-6">
                                        <a class="btn btn-success rounded-4 p-1 fs-6 px-5 my-2  js-stkModal-btn"
                                           data-form-id="formEdit_UMS"
                                           data-url='@Url.Action("_SendAgreement", "SendAgreement", new {requestid = @item.Requestid})'
                                           data-modal-size="lg"><i class="px-2 bi bi-journal-plus"></i>Send Agrement  </a>
                                    </div>
                                }
                                @if (Status == 3)
                                {
                                    <div class="col-6">
                                        <a class="btn btn-warning rounded-4 p-1 fs-6 px-5 my-2 dropdown-item text-dark-emphasis" asp-action="ViewOrder" asp-route-id="@item.Requestid.Encode()" asp-controller="AdminDashboard"><i class="px-2 bi bi-journal-album"></i>Orders</a>
                                    </div>
                                }
                                @if (Status == 4)
                                {
                                    <div class="col-6">
                                        <a class="btn btn-danger rounded-4 p-1 fs-6 px-5 my-2 " asp-action="ConcludeCare" asp-route-id="@item.Requestid.Encode()" asp-controller="SubmitForm"><i class="px-2 bi bi-journal"></i>Conclude Care</a>
                                    </div>
                                }

                                @if ((Status == 4 && item.IsFinalize != null && item.IsFinalize == true) || (@item.IsFinalize != null && @item.IsFinalize == true && Status == 3))
                                {
                                    <div class="col-6">
                                        <a class="btn btn-info rounded-4 p-1 fs-6 px-5 my-2  js-stkModal-btn "
                                           data-form-id="formEdit_UMS"
                                           data-url='@Url.Action("_EncounterPdf", "ViewAction", new {requestid = @item.Requestid})'
                                           data-modal-size="lg"><i class="px-2 bi bi-journal-plus"></i>Encounter pdf </a>
                                    </div>

                                }
                                else if ((@item.IsFinalize != null && @item.IsFinalize == false && Status == 3 && item.Status != 5))
                                {

                                    <div class="col-6">
                                        <a class="btn btn-success rounded-4 p-1 fs-6 px-5 my-2  js-stkModal-btn "
                                           data-form-id="formEdit_UMS"
                                           data-url='@Url.Action("_EncounterModel", "ViewAction", new {requestid = @item.Requestid})'
                                           data-modal-size="lg"><i class="px-2 bi bi-journal-plus"></i>Encounter  model</a>
                                    </div>

                                }
                                else if ((@item.IsFinalize == false && Status == 3) || (@item.IsFinalize == false && Status == 4))
                                {

                                    <div class="col-6">
                                        <a class="btn btn-warning rounded-4 p-1 fs-6 px-5 my-2 " asp-route-id="@item.Requestid.Encode()" asp-action="Encounter" asp-controller="SubmitForm"><i class="px-2 bi bi-journals"></i>Encounter form</a>
                                    </div>
                                }
                                @if (Status > 1)
                                {
                                    <div class="col-6">
                                        <a class="btn btn-warning rounded-4 p-1 fs-6 px-5 my-2" href="/Physician/ViewUpload/@item.Requestid.Encode()"><i class="px-2 bi bi-journal-plus"></i>View Upload </a>
                                    </div>
                                }
                                
                                </div>
                            </div>
                        </div>
                    </div>
            }
        </div>
        <div id="a1a" >
            <table class="table table-responsive" id="table" >
                <thead class="fw-lighter">
                    <tr>
                        <th class="d-none"> No. </th>
                        @foreach (var htmlValue in tdHtmlValues)
                        {
                            <th scope="col" data-order="@Html.Raw(htmlValue)" class="dashborad-table @Html.Raw(htmlValue)">@Html.Raw(htmlValue)</th>
                        }
                    </tr>
                </thead>
                <tbody>
                    @{
                        int i = 1;
                    }
                    @if (Model.DashboardList.Count < 1)
                    {

                        <h1 class="text-center mt-3 text-secondary" >No data Found</h1>

                    }
                    @foreach (var item in Model.DashboardList)
                    {
                        <tr class="bg-@item.RequestTypeID  filterDiv show-table @item.RegionID">
                            <td class="d-none"> @i 
                                @{
                                    i = i + 1;
                                }  </td>
                            <td scope="col">
                                <div class="text-end d-flex justify-content-between">
                                    <div class="text-start d-grid">
                                        @item.PatientName
                                    </div> <div class="text-end verti border border-1 p-1 text-end rounded-1 py-0 btn text-white">
                                        <a class="text-light" href="mailto: @item.Email">  <i class="bi bi-envelope"></i> </a>
                                    </div>
                                </div>
                            </td>

                            
                            @if (Status == 1 || Status == 2 || Status == 3 || Status == 4 || Status == 6)
                            {
                                <td scope="col">
                                    <a class="text-light" href="tel:@item.PhoneNumber"> <div class="border border-1 p-1 rounded-2 text-center w-75 py-1"><i class="bi bi-telephone"></i> @item.PhoneNumber </div>  </a>
                                    <span>
                                        (Patient)
                                    </span>
                                    @{
                                        if (item.RequestTypeID != 2)
                                        {
                                            <a class="text-light" href="tel: @item.RequestorPhoneNumber">  <div class="border border-1 p-1 rounded-2 text-center w-75 py-1"><i class="bi bi-telephone"></i> @item.RequestorPhoneNumber </div> </a>
                                            <span>
                                                @Enum.GetName(typeof(RequestType), item.RequestTypeID)
                                            </span>
                                        }
                                    }

                                </td>
                            }
                            <td scope="col">@item.Address</td>
                            @if (Status == 3)
                            {
                                <td scope="col">
                                   
                                    @if (item.Status == 5)
                                    {
                                        <div data-requestid="@item.Requestid" class="change-state btn btn-info text-white">
                                            House Call
                                        </div>
                                    }else{
                                    <div>
                                        -
                                    </div>
                                    }
                                </td>
                            }
                            <td scope="col" class="action">
                                <div class="dropdown">
                                    <button class="btn border border-1 p-2 rounded-2 text-center w-75 py-1 text-white dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="true">
                                        Actions
                                    </button>

                                    <ul class="dropdown-menu">
                                        @if (Status == 1)
                                        {
                                            <li>
                                                <a class="dropdown-item text-dark-emphasis js-stkModal-btn"
                                                   data-form-id="formEdit_UMS"
                                                   data-url='@Url.Action("_AcceptRequest", "ViewAction", new {requestid = @item.Requestid})'
                                                   data-modal-size="lg"><i class="px-2 bi bi-journal-plus"></i>Accept </a>
                                            </li>

                                        }
                                        <li><a class="dropdown-item text-dark-emphasis" asp-action="Viewcase" asp-route-id="@item.RequestClientid.Encode()" asp-controller="AdminDashboard"><i class="bi bi-journal-minus px-2"></i> View Case</a></li>
                                        <li><a class="dropdown-item text-dark-emphasis" asp-action="ViewNotes" asp-route-id="@item.Requestid.Encode()" asp-controller="AdminDashboard"><i class="px-2 bi bi-journal-medical"></i>View notes</a></li>
                                        
                                        @if (Status == 2)
                                        {
                                            <li>
                                                <a class="btn dropdown-item text-dark-emphasis js-stkModal-btn"
                                                data-form-id="formEdit_UMS"
                                                   data-url='@Url.Action("_TransfertoAdmin", "ViewAction", new {requestid = @item.Requestid})'
                                                   data-modal-size="lg"><i class="px-2 bi bi-journal-plus"></i>Transfer  </a>
                                            </li>
                                            <li>
                                                 <a class="dropdown-item text-dark-emphasis js-stkModal-btn"
                                                data-form-id="formEdit_UMS"
                                                   data-url='@Url.Action("_SendAgreement", "SendAgreement", new {requestid = @item.Requestid})'
                                                   data-modal-size="lg"><i class="px-2 bi bi-journal-plus"></i>Send Agrement  </a></li>
                                        }
                                        @if (Status == 3)
                                        {
                                            <li><a class="dropdown-item text-dark-emphasis" asp-action="ViewOrder" asp-route-id="@item.Requestid.Encode()" asp-controller="AdminDashboard"><i class="px-2 bi bi-journal-album"></i>Orders</a></li>
                                        }
                                        @if (Status == 4)
                                        {
                                            <li><a class="dropdown-item text-dark-emphasis" asp-action="ConcludeCare" asp-route-id="@item.Requestid.Encode()" asp-controller="SubmitForm"><i class="px-2 bi bi-journal"></i>Conclude Care</a></li>
                                        }

                                        @if ((Status == 4 && item.IsFinalize != null && item.IsFinalize == true ) || (@item.IsFinalize != null && @item.IsFinalize == true && Status == 3))
                                        {
                                            <li>
                                                <a class="dropdown-item text-dark-emphasis js-stkModal-btn "
                                                   data-form-id="formEdit_UMS"
                                                   data-url='@Url.Action("_EncounterPdf", "ViewAction", new {requestid = @item.Requestid})'
                                                   data-modal-size="lg"><i class="px-2 bi bi-journal-plus"></i>Encounter  </a>
                                            </li>

                                        }
                                        else if ((@item.IsFinalize != null && @item.IsFinalize == false && Status == 3 && item.Status != 5))
                                        {

                                        <li>
                                            <a class="dropdown-item text-dark-emphasis js-stkModal-btn "
                                               data-form-id="formEdit_UMS"
                                               data-url='@Url.Action("_EncounterModel", "ViewAction", new {requestid = @item.Requestid})'
                                               data-modal-size="lg"><i class="px-2 bi bi-journal-plus"></i>Encounter  </a>
                                            </li>

                                        }
                                        else if ((@item.IsFinalize == false && Status == 3) || (@item.IsFinalize == false && Status == 4))
                                        {

                                            <li><a class="dropdown-item text-dark-emphasis" asp-route-id="@item.Requestid.Encode()" asp-action="Encounter" asp-controller="SubmitForm"><i class="px-2 bi bi-journals"></i>Encounter </a></li>
                                        }
                                        @if (Status > 1)
                                        {
                                            <li><a class="dropdown-item text-dark-emphasis" href="/Physician/ViewUpload/@item.Requestid.Encode()"><i class="px-2 bi bi-journal-plus"></i>View Upload </a></li>
                                        }
                                    </ul>
                                </div>
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>
        <div aria-label="Page navigation example">
            <ul class="pagination pagination-container d-flex justify-content-end">
                <form id="filterFormlist" data-ajax="true" data-ajax-method="post" data-ajax-mode="replace" data-ajax-update="#SearchResult"
                      asp-action="_SearchResult" asp-controller="AdminDashBoard" novalidate="novalidate">

                    <input type="hidden" asp-for="CurrentPage" value="@(Model.CurrentPage-1)" />
                    <input type="hidden" asp-for="RegionId" />
                    <input type="hidden" asp-for="RequestType" />
                    <input type="hidden" asp-for="SearchInput" />
                    <input type="hidden" asp-for="status" />
                    <input type="hidden" asp-for="IsAscending" />
                    <input type="hidden" asp-for="SortedColumn" />

                <li class="page-item mx-1 rounded"><button type="submit" class="@(Model.CurrentPage > 1 ? "" : "disabled") dt-paging-button previous page-link" @(Model.CurrentPage > 1 ? "" : "disabled")>‹</button></li>
                   
                </form>
                @{
                    int start;
                    //<li class="page-item"><a class="page-link">&lt;</a></li>
                    @for (start = 1; start <= @Model.TotalPages; start++)
                    {
                        <form id="filterFormlist" data-ajax="true" data-ajax-method="post" data-ajax-mode="replace" data-ajax-update="#SearchResult"
                              asp-action="_SearchResult" asp-controller="AdminDashBoard" novalidate="novalidate">
                            <input type="hidden" asp-for="RegionId" />
                            <input type="hidden" asp-for="RequestType" />
                            <input type="hidden" asp-for="SearchInput" />
                            <input type="hidden" asp-for="status" />
                            <input type="hidden" asp-for="CurrentPage" value="@start" />
                            <input type="hidden" asp-for="IsAscending" />
                            <input type="hidden" asp-for="SortedColumn" />
                        <li class="page-item mx-1 rounded"><button type="submit" class="@(start == @Model.CurrentPage ? "active" : "") rounded page-link" onclick="pagination(@start)">@start</button></li>
                        </form>

                    }
                    //<li class="page-item"><a class="page-link">&gt;</a></li>
                }
                <form id="filterFormlist" data-ajax="true" data-ajax-method="post" data-ajax-mode="replace" data-ajax-update="#SearchResult"
                      asp-action="_SearchResult" asp-controller="AdminDashBoard" novalidate="novalidate">

                    <input type="hidden" asp-for="CurrentPage" value="@(Model.CurrentPage+1)" />
                    <input type="hidden" asp-for="RegionId" />
                    <input type="hidden" asp-for="RequestType" />
                    <input type="hidden" asp-for="SearchInput" />
                    <input type="hidden" asp-for="status" />
                    <input type="hidden" asp-for="IsAscending" />
                    <input type="hidden" asp-for="SortedColumn" />
                <li class="page-item mx-1 rounded"><button type="submit" class="@(Model.CurrentPage < Model.TotalPages ? "" : "disabled") dt-paging-button previous page-link" @(Model.CurrentPage < Model.TotalPages ? "" : "disabled")>›</button></li>
                   
                </form>
            </ul>
        </div>
    </div>
</div>
</div>
<form id="finlize" asp-action="Conculde" asp-controller="SubmitForm">
    <input name="requestId" type="hidden" value="" id="finalarequestId" />
    <input name="providerId" type="hidden" value="@CV.UserID()" />
</form>
<script>
 
    
    // Function to set initial arrow icon state
    function setInitialArrowState() {
        const headers = $('.dashborad-table.Name, .dashborad-table.Requestor, .dashborad-table.Requested, .dashborad-table.Physician ');

            // Add the arrow-down icon to each selected header
            headers.each(function () {
                if (!$(this).find('.bi-arrow-up').length) {
                    $(this).append('<i class="bi bi-arrow-up btn"></i>');
                }
                $(this).click(function () {
                    const orderValues = $(this).attr('data-order').split(' ')[0];
                    // Call the SetColumValue function passing the array of values
                    SetColumValue(orderValues);
                });
            });

        var modeldata = @Html.Raw(Json.Serialize(Model));
        var headerss = $('.dashborad-table');
        headerss.each(function () {
            var orderValues = $(this).attr('data-order').split(' ')[0];
            if (modeldata.sortedColumn === orderValues) {
                var icon = $(this).find('i.bi.bi-arrow-up, i.bi.bi-arrow-down');
                console.log(icon.find('i.bi.bi-arrow-up, i.bi.bi-arrow-down'));
                if (!modeldata.isAscending) {
                    icon.removeClass('bi-arrow-up').addClass('bi-arrow-down');
                } else {
                    icon.removeClass('bi-arrow-down').addClass('bi-arrow-up');
                }
            }
        });
    }


    function myFunctiona() {
        var input, filter, table, tr, td, i, txtValue;
        input = document.getElementById("myInput");
        filter = input.value.toUpperCase();
        table = document.getElementById("table");
        tr = table.getElementsByTagName("tr");
        for (i = 0; i < tr.length; i++) {
            //if (tr[i].style.display != "none") {

            
                td = tr[i].getElementsByTagName("td")[0];
                if (td  ) {
                    txtValue = td.textContent || td.innerText;
                    if (txtValue.toUpperCase().indexOf(filter) > -1) {
                        tr[i].style.display = "";
                    } else {
                        tr[i].style.display = "none";
                    }
                }
           // }
        }
    }
</script>
<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.21/css/jquery.dataTables.css">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
<script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.10.21/js/jquery.dataTables.js">
</script>
<script>

    $(function () {
        // Add hover-triggered dropdown behavior
        $('.dropdown').hover(function () {
            var $dropdownMenu = $(this).find('.dropdown-menu');
            $dropdownMenu.addClass('show');
            // Adjust position if menu extends beyond viewport
            var dropdownMenuRect = $dropdownMenu[0].getBoundingClientRect();
            var windowWidth = window.innerWidth;
            var windowHeight = window.innerHeight;

            // Check if menu extends beyond the right of the viewport
            if (dropdownMenuRect.right > windowWidth) {
                $dropdownMenu.css('right', 0);
                $dropdownMenu.css('left', 'auto');
            }
            // Check if menu extends beyond the bottom of the viewport
            if (dropdownMenuRect.bottom > windowHeight) {
                $dropdownMenu.css('top', 'auto');
                $dropdownMenu.css('bottom', '100%');
            }
            // Check if menu extends beyond the top of the viewport
            if (dropdownMenuRect.top < 0) {
                $dropdownMenu.css('top', '100%');
                $dropdownMenu.css('bottom', 'auto');
            }
        }, function () {
            $(this).find('.dropdown-menu').removeClass('show');
        });

        // Close dropdown when clicked outside
        $(document).on('click', function (e) {
            if (!$(e.target).closest('.dropdown').length) {
                $('.dropdown-menu').removeClass('show');
            }
        });
        

        $('.ClearCase').click(function () {
           

            Swal.fire({
                title: "Do you want to Clear That requesr ?",
                showDenyButton: false,
                showCancelButton: true,
                confirmButtonText: "Clear",
                denyButtonText: `Don't save`
            }).then((result) => {
                if (result.isConfirmed) {
                    var email = this.getAttribute('data-bs-id')
                    
                    console.log(email);
                    $.ajax({
                        type: "POST",
                        url: '@Url.Action("_ClearCase","ViewAction")?RequestId=' + email,
                        cache: false,
                        success: function (response) {

                            console.log(response);
                        },
                        error: function () {
                            alert("Error while checking email.");
                        }
                    });
                }
                console.log(result);
                /* Read more about isConfirmed, isDenied below */
                if (result.isConfirmed) {
                    Swal.fire("Clear !", "", "success");
                    location.reload();

                } else if (result.isDenied) {
                    Swal.fire("Changes are not saved", "", "info");
                }
            });
        });
    });
    function myFunction() {
        var x = document.getElementById("Region").value;
        console.log(x);
        if (x != 'All Region') {
            filterSelection(x)
        }else{
            filterSelection("all")
        }
        
    }
    filterSelection("all")
    function filterSelection(c) {
        var x, i;
        x = document.getElementsByClassName("filterDiv");
        if (c == "all") c = "";
        for (i = 0; i < x.length; i++) {
            w3RemoveClass(x[i], "show");
            if (x[i].className.indexOf(c) > -1) w3AddClass(x[i], "show");
        }
    }

    function w3AddClass(element, name) {
        var i, arr1, arr2;
        arr1 = element.className.split(" ");
        arr2 = name.split(" ");
        for (i = 0; i < arr2.length; i++) {
            if (arr1.indexOf(arr2[i]) == -1) { element.className += " " + arr2[i]; }
        }
    }

    function w3RemoveClass(element, name) {
        var i, arr1, arr2;
        arr1 = element.className.split(" ");
        arr2 = name.split(" ");
        for (i = 0; i < arr2.length; i++) {
            while (arr1.indexOf(arr2[i]) > -1) {
                arr1.splice(arr1.indexOf(arr2[i]), 1);
            }
        }
        element.className = arr1.join(" ");
    }
  $(document)
        .ready(function () {

            var changeStateButtons = document.querySelectorAll('.change-state');

            changeStateButtons.forEach(function (button) {
                button.addEventListener('click', function () {
                    var requestId = this.dataset.requestid;
                    document.getElementById('finalarequestId').value = requestId;
                    document.getElementById('finlize').submit();
                });
            });

            // On dropdown open
            $(document).on('shown.bs.dropdown', function (event) {
                var dropdown = $(event.target);

                // Set aria-expanded to true
                dropdown.find('.dropdown-menu').attr('aria-expanded', true);

                // Set focus on the first link in the dropdown
                setTimeout(function () {
                    dropdown.find('.dropdown-menu li:first-child a').focus();
                }, 10);
            });

            // On dropdown close
            $(document).on('hidden.bs.dropdown', function (event) {
                var dropdown = $(event.target);

                // Set aria-expanded to false
                dropdown.find('.dropdown-menu').attr('aria-expanded', false);

                // Set focus back to dropdown toggle
                dropdown.find('.dropdown-toggle').focus();
            });
            $("#table_length").hide();
        });
</script>